<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <!--
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    -->
 	<title>Mapeamento de Provedores</title>
	
	<link rel="shortcut icon" href="Public/Imagens/favicon.png" />
    <link rel="stylesheet" href="Public/css/style.css">	
	<link rel="stylesheet" href="Public/css/main.css">
	<link rel="stylesheet" href="Public/css/style_a.css">
    <link rel="stylesheet" href="Public/css/table.css">
    <script src="Public/js/pontos.js" type="text/javascript"></script>
    <script src="Public/js/geral.js" type="text/javascript"></script>
    
    <!-- Bootstrap -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.min.js" integrity="sha512-WW8/jxkELe2CAiE4LvQfwm1rajOS8PHasCCx+knHG0gBHt8EXxS6T6tJRTGuDQVnluuAvMxWF4j8SNFDKceLFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" integrity="sha512-b2QcS5SsA8tZodcDtGRELiGv5SaKSk1vDHDaQRda0htPYWZ6046lr3kJ5bAAQdpV2mmA/4v0wQF9MyU6/pDIAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!--  JQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript">
        if(typeof jQuery === 'undefined'){
              console.log('no jQuery');
                var head = document.getElementsByTagName('head')[0];
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.src = 'Public/js/jquery.min.js';
                script.onload = handler;
                head.appendChild(script);
            }else{console.log('jQuery is embedded!');}
    function handler(){ console.log('jquery added :)'); }
    </script>
    <!--  Cookies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" integrity="sha512-3j3VU6WC5rPQB4Ld1jnLV7Kd5xr+cq9avvhwqzbH/taCRNURoeEpoPBK9pDyeukwSxwRPJ8fDgvYXd6SkaZ2TA==" crossorigin="anonymous"></script>
    <script type="text/javascript" src="Public/js/jquery.cookie.min.js" ></script>
    <script type="text/javascript" src="Public/js/jquery.mask.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>

    <!-- JQuery  Final -->


    <script type="text/javascript" src="local/conf.json"></script>
    <script type="text/javascript">
        var host = 'http://127.0.0.1:8000';
        var sdw_ambiente = "DEV";
        if (conf) { var config = JSON.parse(conf); }
        if (config) {
            var host = config[0].server;    
            var sdw_ambiente = config[0].ambiente ;        
           };
        console.log("Ambiente : " + sdw_ambiente + " | Server : "+ host);    
    </script>	

    
    <style>
       /* Set the size of the div element that contains the map */
      #map {
        height: 400px;  /* The height is 400 pixels */
        width: 100%;  /* The width is the width of the web page */
       }
    </style>
	
	

</head>

<body onload="openWindow()">
<div>
    <nav class="nav_dfh" id="nav_dfh" >
        <div>
            <a class="logo_dfh" href="http://dfhnegocios.com.br/"> <img src="Public/Imagens/DHF_logo.png" alt="logo"  /></a>
        </div>
        <div class="topo_center">
            <p style="text-align: center; font-size: 32px; color: lightskyblue"> Portal SD WAN - Adm</p>
            <!-- <p style="text-align: center; font-size: 32px; color: Silver"> Portal SD WAN - Adm</p> -->
        </div>
	</nav>
    <nav class="nav_top" id="nav_top" hidden>
        <div>
            <a class="logo" href="http://talkd.com.br/"> <img src="Public/Imagens/logo_original_final_branco.png" alt="logo"  /></a>
        </div>
        <div class="topo_center">
            <p style="text-align: center; font-size: 36px; color: ghostwhite"> Portal SD WAN - Adm</p>
        </div>
	</nav>
	<!-- Menu Principal -->
	<div class="menu_top">
		<ul>
			<li><a href="close.html">Sair</a></li>
			<li><a href="ConsoleCliente.html">Console Cliente</a></li>
		</ul>
	</div><br>
<!-- CORPO  -->		
<div style = "width: 100%; display: flex; flex-direction: row; flex-wrap: wrap">
    <div><!--- Coluna 1 -->
	<div class="block_form">
        <!--    FORM  -->
		<form action="mapprovteste.html" method="GET">
		<p> Pesquisar Pontos  </p>       
        <fildset>
            <label style = "width: 80px" for="Empresa">Empresa</label>
                <input style = "width: 140px" class="field" id="Empresa" type="text" readonly>
                <select name = "sel_Empresa" id = "sel_Empresa" style = "width: 20px" >
                    <option value="">Selecione </option>
                    <option value="HUGHES">HUGHES</option>
                    <option value="ALGAR">ALGAR</option>
                    <option value="EMBRATEL">EMBRATEL</option>
                </select>        
         <label style = "width: 40px" for="ctq_Cliente">Cliente</label>
            <input style = "width: 320px" class="field" id="pt_cliente" type="text" readonly hidden >
                <select style = "width: 420px" name = "ctq_Cliente" id = "ctq_Cliente"></select> <!-- Function Cria Maneu -->
            <br>            
        <label style = "width: 80px" for="whe_viabilidade">Status</label>
            <select style = "width: 140px" name = "whe_Viabilidade" id="whe_Viabilidade">
                    <option value=""> Selecionar </option>
                    <option value="Pendente">  Pendente </option>
                    <option value="Ativado Parcial"> Parcialmente Ativo </option>
                    <option value="Cancelado"> Cancelado </option>
                    <option value="Ativo"> Ativo </option>
            </select>  
        <label style = "width: 40px" for="whe_Estado">Estado</label>    
            <select  name = "whe_Estado" id="whe_Estado">
                <option value=""> Selecione </option>
                <option value="AC"> Acre </option>
                <option value="AL"> Alagoas </option>
                <option value="AM"> Amazonas </option>
                <option value="AP"> Amapa </option>
                <option value="BA"> Bahia </option>
                <option value="CE"> Ceara </option>
                <option value="DF"> Distrito Federal </option>
                <option value="ES"> Espirito Santo </option>
                <option value="GO"> Goiais </option>
                <option value="AP"> Amapa </option>
                <option value="MA"> Maranhão </option>
                <option value="MG"> MInas Gerais </option>
                <option value="MS"> Mato Grosso Sul </option>
                <option value="MT"> Mato Grosso </option>
                <option value="PA"> Para </option>
                <option value="PB"> Paraiba </option>
                <option value="PE"> Pernambuco </option>
                <option value="PI"> Piaui </option>
                <option value="PR"> Parana </option>
                <option value="RJ"> Rio de Janeiro </option>
                <option value="RN"> Rio Grande do Norte </option>
                <option value="RO"> Rondonia </option>
                <option value="RR"> Roraima </option>
                <option value="RS"> Rio Grande do Sul </option>
                <option value="SC"> Santa Catarina </option>
                <option value="SE"> Sergipe </option>
                <option value="SP"> São Paulo </option>
                <option value="TO"> Tocantis </option>
            </select>    
        <label style = "width: 40px" for="whe_Cidade">Cidade</label>
			<select name = "whe_Cidade" id="whe_Cidade" style = "width: 220px"></select>
                    
        <input class="button button1" type="button" value="Pesquisar" onclick="load_pontos()"> 


        <div id="mytable" class="table table-striped table-bordered table-sm" style = "overflow-y:scroll; height:388px; width: 100%"></div>
        <!--  <table id="mytable" class="table table-striped table-bordered table-sm"  style="width:100%"></table> -->
                    
            <label style = "width: 80px" for="pt_Tecnologia">ID</label><input style = "width: 80px" class="field" id="pt_ID" type="text" readonly>
            <label style = "width: 80px" for="pt_NomePonto">Identificação</label><input style = "width: 370px" class="field" id="pt_NomePonto" type="text" readonly>
            <label style = "width: 50px" for="pt_IDLoja">ID Loja</label><input style = "width: 60px" class="field" id="pt_IDLoja" type="text" readonly>
            <label style = "width: 60px" for="pt_Viabilidade">Status</label><input style = "width: 140px" class="field" id="pt_Viabilidade" type="text" readonly required>
                <br>    
            <label style = "width: 80px" for="pt_Logradouro">Logradouro</label><input style = "width: 550px" class="field" id="pt_Logradouro" type="text" readonly>
            <label style = "width: 50px" for="pt_Numero">Numero</label><input style = "width: 60px" class="field" id="pt_Numero" type="text" readonly>
            <label style = "width: 80px" for="pt_Complemento">Complemento</label><input style = "width: 120px" class="field" id="pt_Complemento" type="text" readonly>
                <br>    
            <label style = "width: 80px" for="pt_Estado">Estado</label><input style = "width: 80px" class="field" id="pt_Estado" type="text" readonly>
            <label style = "width: 80px" for="pt_Cidade">Cidade</label><input style = "width: 300px" class="field" id="pt_Cidade" type="text" readonly>
            <label style = "width: 80px" for="pt_Bairro">Bairro</label><input style = "width: 140px" class="field" id="pt_Bairro" type="text" readonly>
            <label style = "width: 80px" for="pt_CEP">CEP</label><input style = "width: 80px" class="field" id="pt_CEP" type="text" readonly>
                <br>
            <label style = "width: 80px" for="pt_Observacao">Observacao</label><input style = "width: 900px" class="field" id="pt_Observacao" type="text" readonly>
                <br>
            <label style = "width: 80px" for="pt_CNPJ">CNPJ</label><input style = "width: 160px" class="field" id="pt_CNPJ" type="text" readonly>
            <label style = "width: 60px" for="pt_Regional">Regional</label><input style = "width: 100px" class="field" id="pt_Regional" type="text" readonly>
            <label style = "width: 50px" for="Projeto">Projeto</label><input style = "width: 200px" class="field" id="Projeto" type="text" readonly>
                <br>
            <label style = "width: 150px" for="pt_resultado" hidden >Resultado analise teórica</label>
            <input style = "width: 820px" class="field" id="pt_resultado" type="text" readonly hidden >


		    <!--    Mapa Google  -->
            <div id="map"></div>
            <!--    Links  -->
            <h5>Links</h5>
            <div  id="mytableCobAnalise"  style = "width: 100%; word-wrap: break-word ; table-layout:fixed"></div>

        </fildset>
        </form> 
    </div>	
     
    <div class="block_form" hidden>
        <form><filset>
            <p> Dados Internos</p>
            <label style = "width: 80px" for="pt_Tecnologia">Tecnologia</label><input style = "width: 140px" class="field" id="pt_Tecnologia" type="text" readonly>
            <label style = "width: 60px" for="pt_velocidade">Velocidade</label><input style = "width: 80px" class="field" id="pt_velocidade" type="number" readonly><i>&nbsp;&nbsp;Mbps &nbsp;&nbsp;</i>
            <label style = "width: 120px" for="ct_ID">Cliente ID</label><input style = "width: 60px" class="field" id="ct_ID" type="text" readonly>
            <label style = "width: 80px" for="pt_Latitude">Latitude</label><input style = "width: 120px" class="field" id="pt_Latitude" type="text" readonly>
            <label style = "width: 80px" for="pt_Longitude">Longitude</label><input style = "width: 120px" class="field" id="pt_Longitude" type="text" readonly>
           <!-- <label style = "width: 120px" for="Empresa">Empresa</label><input style = "width: 120px" class="field" id="Empresa" type="textbox" readonly>   -->   
        </filset></form>
    </div>
    </div>
    <div><!--- Coluna 2 -->
             <div class="block_col">
               <h1>DFH Engenharia </h1><hr>
               <p>Usuário</p>
               <label>Login</label><br> <input class="field" id="user_Login" type="email" readonly>
               <label>Nome</label><br> <input class="field" id="user_Nome" type="email" readonly>  
               <label>Empresa</label><br> <input class="field" id="user_Empresa" type="text" value="Empresa...." readonly>
               <hr><br>
            </div>         
        
    </div>    
</div>
</div>
    
        
</body>
<footer>
    <div class="footer" style = "width: 100%; height: 26px ; border: 0px; padding: 1px" hidden >
        <pre style="font-size:14px; padding: 2px" ><b style="font-size:16px" >&nbsp;&nbsp;&nbsp;Talkd</b> | Rua Salvador Simões, 801 sl. 1302 - São Paulo-SP  | TEL.: +55 11 3738-6128 | <b style="font-size:16px" >Evolua</b> de forma positiva a jornada de relacionamento com seus clientes. 
        </pre>
    </div>
</footer>  
    
        
        
<script type="text/javascript">
  var geocoder;
  let map;
    

</script>
        
<script defer
    	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDyfFIiEZ8FVT0-0nbNOU0qZLO3uCtEBtE&callback=initMap">
</script>
    
    <!--Load the API from the specified URL
    * The async attribute allows the browser to render the page while the API loads
    * The key parameter will contain your own API key (which is not needed for this tutorial)
    * The callback parameter executes the initMap() function
    -->		
	
<br><br><br>

<script type="text/javascript">
 document.getElementById("whe_Estado").addEventListener("change", function(){
     menu_Cidade();
});  
  
document.getElementById("ctq_Cliente").addEventListener("change", function(){ 
        var c_id = document.getElementById('ctq_Cliente').value;
        if (c_id != null) { ct_ID.setAttribute("Value", c_id )};
        var elemento = document.getElementById('ctq_Cliente');
        var c_nome = elemento.options[elemento.selectedIndex].innerHTML;
        if (c_nome != null) { pt_cliente.setAttribute("Value", c_nome )};
});     
document.getElementById("sel_Empresa").addEventListener("change", function(){ 
        var elemento = document.getElementById('sel_Empresa');
        var c_nome = elemento.options[elemento.selectedIndex].innerHTML;
        document.getElementById('Empresa').value = c_nome ;
        menu_Clientes();
});      
    
function openWindow(){    
    var sField = sessionStorage.getItem('tkd_Login');    
    user_Login.setAttribute("Value", sField );
    var sField = sessionStorage.getItem('tkd_Nome');    
    user_Nome.setAttribute("Value", sField );      
    var sField = sessionStorage.getItem('tkd_Empresa');    
    user_Empresa.setAttribute("Value", sField );
    //Empresa.setAttribute("Value", sField );
    // prepara menu Cliente
    var c_empresa = sField = sessionStorage.getItem('tkd_Empresa'); 

    if ( sField != null ) { var tkd_Empresa = sessionStorage.getItem('tkd_Empresa').trim(); } 
    
    if ( tkd_Empresa != "DFH"){
            document.getElementById("sel_Empresa").hidden = true;
            document.getElementById('Empresa').value = tkd_Empresa ;

        }
    menu_Clientes();

}
    
    
    
function load_pontos() {   
    const header  = document.querySelector('header');
    const section = document.querySelector('section');
	let headers = new Headers();
 	headers.append('Content-Type', 'application/json');
    headers.append('Accept', 'application/json');
    headers.append('Access-Control-Allow-Origin', '*' );
    headers.append('Access-Control-Allow-Credentials', 'true');
	headers.append('GET', 'POST', 'OPTIONS');
    headers.append('Upgrade-Insecure-Requests', '1');
	headers.append('Content-Security-Policy', 'upgrade-insecure-requests');

	
    // ---  Chause Where
    var empresa = document.getElementById('Empresa').value;
    var whe_Viabilidade = document.getElementById('whe_Viabilidade').value;   
    var whe_Estado = document.getElementById('whe_Estado').value;   
    var whe_Cidade = document.getElementById('whe_Cidade').value;
    var whe_Cliente = document.getElementById('ctq_Cliente').value;

	var requestURL = host + '/pontos?empresa='+empresa
    if ( whe_Viabilidade != "") { requestURL = requestURL + '&Viabilidade='+ whe_Viabilidade }; 
    if ( whe_Estado != "" ) { requestURL = requestURL + '&Estado='+ whe_Estado }; 
    if ( whe_Cidade != "" ) { requestURL = requestURL + '&Cidade='+ whe_Cidade }; 
    if ( whe_Cliente != "" ) { requestURL = requestURL + '&Cliente='+whe_Cliente }; 

        
    // console.log(requestURL);
        
	var request = new XMLHttpRequest();
	request.open('GET', requestURL);

	request.responseType = 'json';
	request.send();	

        request.onload = function() {
	       var pontos = request.response;
	           g_table(pontos);	}
}

    
function g_table(jsonObj) {
	var lugares = jsonObj;	
    // console.log(jsonObj);
        while (mytable.hasChildNodes()) { mytable.removeChild(mytable.lastChild);
			}
        var mybody = document.getElementsByTagName("mytable")[0];
        
        mytablebody = document.createElement("tbody");

	  // <!-- Cabeçalho da tabela -->
		t_colunas = ["Identificação","Logradouro","UF","Cidade","Status"," "];
		myheader=document.createElement("tr");
        
		var zcol_count = t_colunas.length;		
		for(var zcol = 0 ; zcol < zcol_count ; zcol++) { 
			mycurrent_header=document.createElement("th");
			currentheader = document.createTextNode(t_colunas[zcol]);
			mycurrent_header.appendChild(currentheader);
			myheader.appendChild(mycurrent_header);		
		}
		mytablebody.appendChild(myheader);
		    //for(var g_i = 0 ; g_i < 30 ; g_i++) {
            for(var g_i = 0 ; g_i < lugares.length ; g_i++) {
			   mycurrent_row = document.createElement("tr"); 
               
				   mycurrent_cell = document.createElement("td");
                   mycurrent_cell.setAttribute("style", "word-wrap: break-word; font-size: 12px; width: 30%");
                   conteudo = lugares[g_i].NomePonto;
                    if (conteudo == null) { conteudo = ""; };
				   currenttext = document.createTextNode(conteudo);
               	   mycurrent_cell.setAttribute("ID",'bt_'+conteudo);
                   //console.log(mycurrent_cell);
				   mycurrent_cell.appendChild(currenttext);
				   mycurrent_row.appendChild(mycurrent_cell);
               
				   mycurrent_cell = document.createElement("td");
                   mycurrent_cell.setAttribute("style", "word-wrap: break-word; font-size: 12px; width: 24%");
                   var rua = lugares[g_i].Logradouro;
                   var numero = lugares[g_i].Numero;
                   conteudo = rua + ", "+ numero ;
			   	   currenttext = document.createTextNode(conteudo);
				   mycurrent_cell.appendChild(currenttext);
				   mycurrent_row.appendChild(mycurrent_cell);		   
				   
				   mycurrent_cell = document.createElement("td");
                   mycurrent_cell.setAttribute("style", "word-wrap: break-word; font-size: 12px; width: 6%");
                   conteudo = lugares[g_i].Estado;
			   	   currenttext = document.createTextNode(conteudo);
				   mycurrent_cell.appendChild(currenttext);
				   mycurrent_row.appendChild(mycurrent_cell);
                
                   mycurrent_cell = document.createElement("td");
                   mycurrent_cell.setAttribute("style", "word-wrap: break-word; font-size: 12px; width: 12%");
                   conteudo = lugares[g_i].Cidade;
			   	   currenttext = document.createTextNode(conteudo);
				   mycurrent_cell.appendChild(currenttext);
				   mycurrent_row.appendChild(mycurrent_cell);
			   
				   mycurrent_cell = document.createElement("td");
                   mycurrent_cell.setAttribute("style", "word-wrap: break-word; font-size: 12px; width: 18%");
                   conteudo = lugares[g_i].viabilidade;
                    if (conteudo == null) { conteudo = ""; }
                   currenttext = document.createTextNode(conteudo);
				   mycurrent_cell.appendChild(currenttext);
				   mycurrent_row.appendChild(mycurrent_cell);
               
                   mycurrent_cell = document.createElement("td");
                   mycurrent_cell.setAttribute("style", "word-wrap: break-word; font-size: 10px;  color:cadetblue ;width: 6%");
			   	   currenttext = document.createTextNode('DETALHE');
                   mycurrent_cell.setAttribute("ID",'btn_'+(g_i+1));
                   var btn_ID = lugares[g_i].ID;
                   var click = 'clicar('+btn_ID+')';
                   //var click = 'clicar(lugares,'+(g_i+1)+')';
                   //console.log(click);
                   mycurrent_cell.setAttribute("onclick", click);
                   //console.log(mycurrent_cell);
				   mycurrent_cell.appendChild(currenttext);
				   mycurrent_row.appendChild(mycurrent_cell);
               	   			   
			    mytablebody.appendChild(mycurrent_row);
		   }
       mytable.appendChild(mytablebody);
       //pagination.appendChild(mytable);
}


// Apresentar Detalhes do Ponto
function clicar(btn_id){
        var p_id = btn_id;
        // console.log(p_id);
        const header  = document.querySelector('header');
        const section = document.querySelector('section');
        let headers = new Headers();
        headers.append('Content-Type', 'application/json');
        headers.append('Accept', 'application/json');
        headers.append('Access-Control-Allow-Origin', '*' );
        headers.append('Access-Control-Allow-Credentials', 'true');
        headers.append('GET', 'POST', 'OPTIONS');
        headers.append('Upgrade-Insecure-Requests', '1');
        headers.append('Content-Security-Policy', 'upgrade-insecure-requests');
   
        var requestURL = host + '/ponto/' + btn_id ;
        // console.log(requestURL);

        var request = new XMLHttpRequest();
		//request.setRequestHeader(headers);
        request.open('GET', requestURL);
        request.responseType = 'json';
        request.send();

        request.onload = function() {
        var pontos = request.response;	
        //console.log(pontos);    
            conteudo =   pontos[0].ID;
            if (conteudo != null) { pt_ID.setAttribute("Value", conteudo )};
            conteudo =   pontos[0].NomePonto;
            if (conteudo != null) { pt_NomePonto.setAttribute("Value", conteudo ) };
            conteudo =   pontos[0].viabilidade;
            if (conteudo != null) { pt_Viabilidade.setAttribute("Value", conteudo )};
            conteudo =   pontos[0].Logradouro;
            if (conteudo != null) { pt_Logradouro.setAttribute("Value", conteudo) };
            conteudo =   pontos[0].Numero;
            if (conteudo != null) { pt_Numero.setAttribute("Value", conteudo) };            
            conteudo =   pontos[0].Complemento;
            if (conteudo != null) { pt_Complemento.setAttribute("Value", conteudo) };  
            conteudo =   pontos[0].Estado;
            if (conteudo != null) { pt_Estado.setAttribute("Value", conteudo) };  
            conteudo =   pontos[0].Cidade;
            if (conteudo != null) { pt_Cidade.setAttribute("Value", conteudo) };            
            conteudo =   pontos[0].Bairro;
            if (conteudo != null) { pt_Bairro.setAttribute("Value", conteudo) };             
            conteudo =   pontos[0].CEP;
            if (conteudo != null) { pt_CEP.setAttribute("Value", conteudo) };             
            latitude =   pontos[0].Latitude;
            if (latitude != null) { pt_Latitude.setAttribute("Value", latitude) };             
            longitude =   pontos[0].Longitude;
            if (longitude != null) { pt_Longitude.setAttribute("Value", longitude) }; 
            conteudo =   pontos[0].Tecnologia;
            if (conteudo != null) { pt_Tecnologia.setAttribute("Value", conteudo) };            
            conteudo =   pontos[0].Velocidade;
            if (conteudo != null) { pt_Velocidade.setAttribute("Value", conteudo) };                 
            conteudo =   pontos[0].Observacao;
            if (conteudo != null) { pt_Observacao.setAttribute("Value", conteudo) }; 
            conteudo =   pontos[0].loja_id;
            if (conteudo != null) { pt_IDLoja.setAttribute("Value", conteudo.trim()) }; 
            conteudo =   pontos[0].cnpj;
            if (conteudo != null) { pt_CNPJ.setAttribute("Value", conteudo.trim()) }; 
            conteudo =   pontos[0].regional;
            if (conteudo != null) { pt_Regional.setAttribute("Value", conteudo.trim()) }; 
            conteudo =   pontos[0].projeto;
            if (conteudo != null) { Projeto.setAttribute("Value", conteudo.trim()) };
             conteudo =   pontos[0].analise_teo;
            if (conteudo != null) { pt_resultado.setAttribute("Value", conteudo.trim()) };           
            
                GeoMapp(latitude, longitude);
                CobAnaliseGet();
        }        
}

	
function GeoMapp(latitude, Longitude) {
      var latitude = latitude;
      var longitude = Longitude;
      var location  = 'center: {lat: ' + latitude + ', lng: ' + longitude + '}';
      var posicao   = 'position: {lat: ' + latitude + ', lng: ' + longitude + '}';
      var mapOp  = '{lat: ' + latitude + ', lng: ' + longitude + '}';
      const mapOptions = { zoom: 12, center: { lat: latitude , lng: longitude }, };
      map = new google.maps.Map(document.getElementById("map"), mapOptions);
      const marker = new google.maps.Marker({
        // The below line is equivalent to writing:
        // position: new google.maps.LatLng(-34.397, 150.644)
        position: { lat: latitude, lng: longitude },
        map: map,
      });
      // You can use a LatLng literal in place of a google.maps.LatLng object when
      // creating the Marker object. Once the Marker object is instantiated, its
      // position will be available as a google.maps.LatLng object. In this case,
      // we retrieve the marker's position using the
      // google.maps.LatLng.getPosition() method.
      const infowindow = new google.maps.InfoWindow({
        content: "<p>Marker Location:" + marker.getPosition() + "</p>",
      });
      google.maps.event.addListener(marker, "click", () => {
        infowindow.open(map, marker);
      });
}

    
    


</script>
</html>

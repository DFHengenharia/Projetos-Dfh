<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>Carga</title>

    <link rel="shortcut icon" href="Public/Imagens/favicon.png" />
	<link rel="stylesheet"    href="Public/css/style.css">
    <link rel="stylesheet"    href="Public/css/main.css">
    <link rel="stylesheet"    href="Public/css/style_a.css">
    <link rel="stylesheet"    href="Public/css/table.css">
    <script src="Public/js/geral.js" type="text/javascript"></script>
    <script src="Public/js/pontos.js" type="text/javascript"></script>
    <script src="Public/js/Clot.js" type="text/javascript"></script>

    <script src="https://d3js.org/d3.v6.min.js"></script>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <!--  JQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <!--  Cookies-->
    <script type="text/javascript" src="Public/js/jquery.cookie.min.js" ></script>
    <!-- DFH Project
    AIzaSyBgffxsyaBHuqoVSjs9ZlxPB-NhMydhsKQ
    -->
    <script type="text/javascript">
        if(typeof jQuery === 'undefined'){
              console.log('no jQuery');
                var head = document.getElementsByTagName('head')[0];
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.src = 'Public/js/jquery-3.6.0.min.js';
                script.onload = handler;
                head.appendChild(script);
            }else{console.log('jQuery is embedded!');}
    function handler(){ console.log('jquery added :)'); }
    </script>
    <!--<script type="text/javascript" src="../local/conf.json"></script>-->
    <script type="text/javascript" src="../local/confip.json"></script>
    <script type="text/javascript">
        var host = 'http://127.0.0.1:8000';
        var sdw_ambiente = "DEV";
        var sdw_owner = "DFH";
        console.log(conf);
        if (conf) { var config = JSON.parse(conf); }
        console.log(conf);
        if (config) {
            host = config[0].server;
            sdw_ambiente = config[0].ambiente ;
            sdw_owner = config[0].HEAD;
           }
        console.log("Ambiente : " + sdw_ambiente + " | Owner : " + sdw_owner +  " | Server : "+ host);
    </script>

    <!-- Planilha XLS -->
    <script type="text/javascript" src="Public/js/xlsx.full.min.js"></script>
</head>

<body onload="loadWindow()">

<div>
	<nav class="nav_top" hidden >
		   <div>
		  	    <a class="logo" href="http://talkd.com.br/">
	  				<img src="/Public/Imagens/logo_original_final_branco.png" alt="logo"  /></a>
			 </div>
			 <div class="topo_center">
			      <p style="text-align: center; font-size: 36px; color: ghostwhite"> Portal SD WAN </p>
			 </div>

	</nav>
	<!-- Menu Principal -->
	<div>

    <div class="block_line">
        <div>&nbsp;&nbsp;</div>
        <div><h4 id="divOwner" style="color: #9926b0 ">Talkd |</h4></div>
        <div></div>
        <div><h4 style="color: #9926b0">Portal SDWAN </h4></div>
        <div>&nbsp;&nbsp;&nbsp;&nbsp;</div>
        <div><label style = "width: 40px" for="user_Login">Login</label></div>
        <div><input style = "width: 80px"  class="field" id="user_Login" type="text" readonly></div>
        <div><label style = "width: 40px" for="user_Nome" >Nome</label></div>
        <div><input style = "width: 220px" class="field" id="user_Nome" type="text" readonly> </div>
        <div><label style = "width: 60px" for="user_Empresa">Empresa</label></div>
        <div><input style = "width: 120px" class="field" id="user_Empresa" type="text" readonly></div>
        <div>&nbsp;&nbsp;&nbsp;&nbsp;</div>
        <div>&nbsp;&nbsp;</div>
        <div><a onclick="fnConsole()" >Console</a></div>
        <div>&nbsp;&nbsp;</div>
        <div><a href="close.html">Sair</a></div>

    </div>
	</div>
	<div class="block_form">
		<form>
            <fieldset>
            <br>
            <p>Carregar planilha para inclusão em lote de novos pontos</p>
            <br>
            <i>Passo 1 - Baixar planilha modelo</i><br>
            <a id="LinkPlanilha" href="#" onclick="ExcelDow()" style="padding-left: 80px; font-size: 14px;">Click aqui para baixar planilha referência </a>
            <!-- <a id="LinkPlanilha" href="#" onclick="ExcelDow()" style="padding-left: 80px; font-size: 14px;">Baixar Planilha </a> -->
            <br><br>
            <i>Passo 2 -  Selecionar Arquivos xlsx </i><br>
            <input class="button button2"  type="file" id="file">
            <label style = "width: 100px; font-size: 12px; color: cornflowerblue; border-left: 40px" for="ca_Registros">Registros Carregado</label>
                    <input style = "width: 80px; font-size: 12px; color: cornflowerblue; border-width: 0 " class="field" id="ca_Registros" type="number" readonly>
            <br><br>
            <i>Passo 3 -  Identifique cliente </i><br>
            <label style = "width: 80px" for="Empresa">Empresa</label>
              <input style = "width: 130px" class="field" id="Empresa" type="text" value="HUGHES" readonly required>
                  <select name = "sel_Empresa" id = "sel_Empresa" style = "width: 20px" ></select>
            <label style = "width: 44px" for="pt_cliente">Cliente</label>
                    <input style = "width: 320px" class="field" id="pt_cliente" type="text" readonly required>
                         <select style = "width: 20px" name = "ctq_Cliente" id = "ctq_Cliente"></select> <!-- Function Cria Maneu -->
            <br>
            <label style = "width: 80px" for="Projeto">Projeto</label>
                <input style = "width: 160px" class="field" id="Projeto" type="text">
            <br><br>
            <i>Passo 4 - Analisar Arquivo </i><br>
            <input class="button button1" type="button"  value="Apenas Analisar" onclick="insert('SIMULAR')">
            <input class="button button2" type="button"  value="Baixar Analise" onclick="BaixarAnalise()">
            <br><br>
            <i>Passo 5 - Importar </i><br>
            <input class="button button1" type="button"  value="Incluir Ponto para Analise" onclick="insert()">
            <br>
            <!-- <h6>Importar</h6> -->
            <br>
                <h6>enviados: </h6>
                <ul id="ul_enviado" style="text-decoration: None  ; font-size: 8px "></ul>
            <br>
                 <h6>importados: </h6>
                 <ul id="ul_importado" style="text-decoration: None  ; font-size: 8px "></ul>
            <br>



            </fieldset>
		</form>
		<br>
	</div>

	<div class="block_form" hidden>
	<form><fieldset>
		<label style = "width: 120px" for="ct_ID">Cliente ID</label><input style = "width: 60px" class="field" id="ct_ID" type="text" readonly>


		</fieldset></form>

	</div>

</div>
	<br>
</body>
  <footer>
    <div class="footer" style = "width: 100%; height: 26px ; border: 0; padding: 1px">
        <pre style="font-size:14px; padding: 2px" ><b style="font-size:16px" >&nbsp;&nbsp;&nbsp;Talkd</b> | Rua Salvador Simões, 801 sl. 1302 - São Paulo-SP  | TEL.: +55 11 3738-6128 | <b style="font-size:16px" >Evolua</b> de forma positiva a jornada de relacionamento com seus clientes.
        </pre>
    </div>
</footer>

</html>








<!--  **************************************** -->

<script type="text/javascript">
var Carga
var resp_post;
var log;
var request = new XMLHttpRequest();
var Analise= new Array();
request.addEventListener('load',  function() {  handleEvent(request) });


//First monitor the input box changes, select a new file will trigger the change event
document.querySelector("#file").addEventListener("change", function () {
    //Get the selected file
    var file = document.querySelector("#file").files[0];
    var type = file.name.split('.');
    if (type[type.length - 1] !== 'xlsx' && type[type.length - 1] !== 'xls') {
             alert('Only select excel file to import');
      return false;
    }
    const reader = new FileReader();
    reader.readAsBinaryString(file);
    reader.onload = (e) => {
      const data = e.target.result;
      const zzexcel = window.XLS.read(data, {
        type: 'binary'
      });
      const result = [];
      for (let i = 0; i < zzexcel.SheetNames.length; i++) {
        const newData = window.XLS.utils.sheet_to_json(zzexcel.Sheets[zzexcel.SheetNames[i]]);
        result.push(...newData)
      }
      // console.log('result', result);
	  Carga = result ;

    var registros = Carga.length;
    document.getElementById('ca_Registros').value = registros ;
    }
  });

document.getElementById("ctq_Cliente").addEventListener("change", function(){
        var c_id = document.getElementById('ctq_Cliente').value;
        if (c_id != null) { ct_ID.setAttribute("Value", c_id )}
        var elemento = document.getElementById('ctq_Cliente');
        var c_nome = elemento.options[elemento.selectedIndex].innerHTML;
        if (c_nome != null) { pt_cliente.setAttribute("Value", c_nome )}
});
document.getElementById("sel_Empresa").addEventListener("change", function(){
        var elemento = document.getElementById('sel_Empresa');
        var c_nome = elemento.options[elemento.selectedIndex].innerHTML;
        document.getElementById('Empresa').value = c_nome ;
        menu_Clientes();
});
request.addEventListener('onload',  function() {  handleEvent(request) });

request.addEventListener('load',  function() {  handleEvent(request) });

function loadWindow(){
    loadSession();
	menu_Clientes();
    menuEmpresas("sel_Empresa");
}
function fnConsole(){
    if ( tkd_Empresa === "DFH" ) { window.open('../portal.html', "_self");
    } else { window.open('../ConsoleCliente.html', "_self" ); }
}


</script>




